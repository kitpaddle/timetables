let tempData = {
  "Departure": [
    {
      "JourneyDetailRef": {
        "ref": "1|52090|14|1|5032024"
      },
      "JourneyStatus": "P",
      "ProductAtStop": {
        "icon": {
          "res": "prod_gen"
        },
        "name": "Flygtransfer - Buss .",
        "internalName": "Flygtransfer - Buss .",
        "displayNumber": ".",
        "num": ".",
        "line": ".",
        "lineId": "1277098400001",
        "catOut": "BAX",
        "catIn": "BAX",
        "catCode": "3",
        "cls": "8",
        "catOutS": "BAX",
        "catOutL": "Flygtransfer - Buss",
        "operatorCode": "277",
        "operator": "Flygbussarna",
        "admin": "277___",
        "matchId": "984;984;227609"
      },
      "Product": [
        {
          "icon": {
            "res": "prod_gen"
          },
          "name": "Flygtransfer - Buss .",
          "internalName": "Flygtransfer - Buss .",
          "displayNumber": ".",
          "num": ".",
          "line": ".",
          "lineId": "1277098400001",
          "catOut": "BAX",
          "catIn": "BAX",
          "catCode": "3",
          "cls": "8",
          "catOutS": "BAX",
          "catOutL": "Flygtransfer - Buss",
          "operatorCode": "277",
          "operator": "Flygbussarna",
          "admin": "277___",
          "routeIdxFrom": 4,
          "routeIdxTo": 11,
          "matchId": "984;984;227609"
        }
      ],
      "Notes": {
        "Note": [
          {
            "value": "WiFi",
            "key": "AW",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "WiFi"
          },
          {
            "value": "Lag 2015:953 tillämpas",
            "key": "EG",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "Lag 2015:953 tillämpas"
          }
        ]
      },
      "name": "Flygtransfer - Buss .",
      "type": "ST",
      "stop": "Torsplan (Stockholm kn)",
      "stopid": "A=1@O=Torsplan (Stockholm kn)@X=18032883@Y=59345400@U=1@L=740046074@",
      "stopExtId": "740046074",
      "time": "11:15:00",
      "date": "2024-03-05",
      "reachable": true,
      "direction": "Arlanda terminal 2-3 buss (Sigtuna kn)",
      "directionFlag": "2"
    },
    {
      "JourneyDetailRef": {
        "ref": "1|52090|15|1|5032024"
      },
      "JourneyStatus": "P",
      "ProductAtStop": {
        "icon": {
          "res": "prod_gen"
        },
        "name": "Flygtransfer - Buss .",
        "internalName": "Flygtransfer - Buss .",
        "displayNumber": ".",
        "num": ".",
        "line": ".",
        "lineId": "1277098400001",
        "catOut": "BAX",
        "catIn": "BAX",
        "catCode": "3",
        "cls": "8",
        "catOutS": "BAX",
        "catOutL": "Flygtransfer - Buss",
        "operatorCode": "277",
        "operator": "Flygbussarna",
        "admin": "277___",
        "matchId": "984;984;227636"
      },
      "Product": [
        {
          "icon": {
            "res": "prod_gen"
          },
          "name": "Flygtransfer - Buss .",
          "internalName": "Flygtransfer - Buss .",
          "displayNumber": ".",
          "num": ".",
          "line": ".",
          "lineId": "1277098400001",
          "catOut": "BAX",
          "catIn": "BAX",
          "catCode": "3",
          "cls": "8",
          "catOutS": "BAX",
          "catOutL": "Flygtransfer - Buss",
          "operatorCode": "277",
          "operator": "Flygbussarna",
          "admin": "277___",
          "routeIdxFrom": 4,
          "routeIdxTo": 11,
          "matchId": "984;984;227636"
        }
      ],
      "Notes": {
        "Note": [
          {
            "value": "WiFi",
            "key": "AW",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "WiFi"
          },
          {
            "value": "Lag 2015:953 tillämpas",
            "key": "EG",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "Lag 2015:953 tillämpas"
          }
        ]
      },
      "name": "Flygtransfer - Buss .",
      "type": "ST",
      "stop": "Torsplan (Stockholm kn)",
      "stopid": "A=1@O=Torsplan (Stockholm kn)@X=18032883@Y=59345400@U=1@L=740046074@",
      "stopExtId": "740046074",
      "time": "11:45:00",
      "date": "2024-03-05",
      "reachable": true,
      "direction": "Arlanda terminal 2-3 buss (Sigtuna kn)",
      "directionFlag": "2"
    },
    {
      "JourneyDetailRef": {
        "ref": "1|52090|16|1|5032024"
      },
      "JourneyStatus": "P",
      "ProductAtStop": {
        "icon": {
          "res": "prod_gen"
        },
        "name": "Flygtransfer - Buss .",
        "internalName": "Flygtransfer - Buss .",
        "displayNumber": ".",
        "num": ".",
        "line": ".",
        "lineId": "1277098400001",
        "catOut": "BAX",
        "catIn": "BAX",
        "catCode": "3",
        "cls": "8",
        "catOutS": "BAX",
        "catOutL": "Flygtransfer - Buss",
        "operatorCode": "277",
        "operator": "Flygbussarna",
        "admin": "277___",
        "matchId": "984;984;227663"
      },
      "Product": [
        {
          "icon": {
            "res": "prod_gen"
          },
          "name": "Flygtransfer - Buss .",
          "internalName": "Flygtransfer - Buss .",
          "displayNumber": ".",
          "num": ".",
          "line": ".",
          "lineId": "1277098400001",
          "catOut": "BAX",
          "catIn": "BAX",
          "catCode": "3",
          "cls": "8",
          "catOutS": "BAX",
          "catOutL": "Flygtransfer - Buss",
          "operatorCode": "277",
          "operator": "Flygbussarna",
          "admin": "277___",
          "routeIdxFrom": 4,
          "routeIdxTo": 11,
          "matchId": "984;984;227663"
        }
      ],
      "Notes": {
        "Note": [
          {
            "value": "WiFi",
            "key": "AW",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "WiFi"
          },
          {
            "value": "Lag 2015:953 tillämpas",
            "key": "EG",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "Lag 2015:953 tillämpas"
          }
        ]
      },
      "name": "Flygtransfer - Buss .",
      "type": "ST",
      "stop": "Torsplan (Stockholm kn)",
      "stopid": "A=1@O=Torsplan (Stockholm kn)@X=18032883@Y=59345400@U=1@L=740046074@",
      "stopExtId": "740046074",
      "time": "12:15:00",
      "date": "2024-03-05",
      "reachable": true,
      "direction": "Arlanda terminal 2-3 buss (Sigtuna kn)",
      "directionFlag": "2"
    },
    {
      "JourneyDetailRef": {
        "ref": "1|52090|17|1|5032024"
      },
      "JourneyStatus": "P",
      "ProductAtStop": {
        "icon": {
          "res": "prod_gen"
        },
        "name": "Flygtransfer - Buss .",
        "internalName": "Flygtransfer - Buss .",
        "displayNumber": ".",
        "num": ".",
        "line": ".",
        "lineId": "1277098400001",
        "catOut": "BAX",
        "catIn": "BAX",
        "catCode": "3",
        "cls": "8",
        "catOutS": "BAX",
        "catOutL": "Flygtransfer - Buss",
        "operatorCode": "277",
        "operator": "Flygbussarna",
        "admin": "277___",
        "matchId": "984;984;227690"
      },
      "Product": [
        {
          "icon": {
            "res": "prod_gen"
          },
          "name": "Flygtransfer - Buss .",
          "internalName": "Flygtransfer - Buss .",
          "displayNumber": ".",
          "num": ".",
          "line": ".",
          "lineId": "1277098400001",
          "catOut": "BAX",
          "catIn": "BAX",
          "catCode": "3",
          "cls": "8",
          "catOutS": "BAX",
          "catOutL": "Flygtransfer - Buss",
          "operatorCode": "277",
          "operator": "Flygbussarna",
          "admin": "277___",
          "routeIdxFrom": 4,
          "routeIdxTo": 11,
          "matchId": "984;984;227690"
        }
      ],
      "Notes": {
        "Note": [
          {
            "value": "WiFi",
            "key": "AW",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "WiFi"
          },
          {
            "value": "Lag 2015:953 tillämpas",
            "key": "EG",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "Lag 2015:953 tillämpas"
          }
        ]
      },
      "name": "Flygtransfer - Buss .",
      "type": "ST",
      "stop": "Torsplan (Stockholm kn)",
      "stopid": "A=1@O=Torsplan (Stockholm kn)@X=18032883@Y=59345400@U=1@L=740046074@",
      "stopExtId": "740046074",
      "time": "12:45:00",
      "date": "2024-03-05",
      "reachable": true,
      "direction": "Arlanda terminal 2-3 buss (Sigtuna kn)",
      "directionFlag": "2"
    },
    {
      "JourneyDetailRef": {
        "ref": "1|52090|18|1|5032024"
      },
      "JourneyStatus": "P",
      "ProductAtStop": {
        "icon": {
          "res": "prod_gen"
        },
        "name": "Flygtransfer - Buss .",
        "internalName": "Flygtransfer - Buss .",
        "displayNumber": ".",
        "num": ".",
        "line": ".",
        "lineId": "1277098400001",
        "catOut": "BAX",
        "catIn": "BAX",
        "catCode": "3",
        "cls": "8",
        "catOutS": "BAX",
        "catOutL": "Flygtransfer - Buss",
        "operatorCode": "277",
        "operator": "Flygbussarna",
        "admin": "277___",
        "matchId": "984;984;227717"
      },
      "Product": [
        {
          "icon": {
            "res": "prod_gen"
          },
          "name": "Flygtransfer - Buss .",
          "internalName": "Flygtransfer - Buss .",
          "displayNumber": ".",
          "num": ".",
          "line": ".",
          "lineId": "1277098400001",
          "catOut": "BAX",
          "catIn": "BAX",
          "catCode": "3",
          "cls": "8",
          "catOutS": "BAX",
          "catOutL": "Flygtransfer - Buss",
          "operatorCode": "277",
          "operator": "Flygbussarna",
          "admin": "277___",
          "routeIdxFrom": 4,
          "routeIdxTo": 11,
          "matchId": "984;984;227717"
        }
      ],
      "Notes": {
        "Note": [
          {
            "value": "WiFi",
            "key": "AW",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "WiFi"
          },
          {
            "value": "Lag 2015:953 tillämpas",
            "key": "EG",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "Lag 2015:953 tillämpas"
          }
        ]
      },
      "name": "Flygtransfer - Buss .",
      "type": "ST",
      "stop": "Torsplan (Stockholm kn)",
      "stopid": "A=1@O=Torsplan (Stockholm kn)@X=18032883@Y=59345400@U=1@L=740046074@",
      "stopExtId": "740046074",
      "time": "13:15:00",
      "date": "2024-03-05",
      "reachable": true,
      "direction": "Arlanda terminal 2-3 buss (Sigtuna kn)",
      "directionFlag": "2"
    },
    {
      "JourneyDetailRef": {
        "ref": "1|52090|19|1|5032024"
      },
      "JourneyStatus": "P",
      "ProductAtStop": {
        "icon": {
          "res": "prod_gen"
        },
        "name": "Flygtransfer - Buss .",
        "internalName": "Flygtransfer - Buss .",
        "displayNumber": ".",
        "num": ".",
        "line": ".",
        "lineId": "1277098400001",
        "catOut": "BAX",
        "catIn": "BAX",
        "catCode": "3",
        "cls": "8",
        "catOutS": "BAX",
        "catOutL": "Flygtransfer - Buss",
        "operatorCode": "277",
        "operator": "Flygbussarna",
        "admin": "277___",
        "matchId": "984;984;227744"
      },
      "Product": [
        {
          "icon": {
            "res": "prod_gen"
          },
          "name": "Flygtransfer - Buss .",
          "internalName": "Flygtransfer - Buss .",
          "displayNumber": ".",
          "num": ".",
          "line": ".",
          "lineId": "1277098400001",
          "catOut": "BAX",
          "catIn": "BAX",
          "catCode": "3",
          "cls": "8",
          "catOutS": "BAX",
          "catOutL": "Flygtransfer - Buss",
          "operatorCode": "277",
          "operator": "Flygbussarna",
          "admin": "277___",
          "routeIdxFrom": 4,
          "routeIdxTo": 11,
          "matchId": "984;984;227744"
        }
      ],
      "Notes": {
        "Note": [
          {
            "value": "WiFi",
            "key": "AW",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "WiFi"
          },
          {
            "value": "Lag 2015:953 tillämpas",
            "key": "EG",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "Lag 2015:953 tillämpas"
          }
        ]
      },
      "name": "Flygtransfer - Buss .",
      "type": "ST",
      "stop": "Torsplan (Stockholm kn)",
      "stopid": "A=1@O=Torsplan (Stockholm kn)@X=18032883@Y=59345400@U=1@L=740046074@",
      "stopExtId": "740046074",
      "time": "13:45:00",
      "date": "2024-03-05",
      "reachable": true,
      "direction": "Arlanda terminal 2-3 buss (Sigtuna kn)",
      "directionFlag": "2"
    },
    {
      "JourneyDetailRef": {
        "ref": "1|52090|20|1|5032024"
      },
      "JourneyStatus": "P",
      "ProductAtStop": {
        "icon": {
          "res": "prod_gen"
        },
        "name": "Flygtransfer - Buss .",
        "internalName": "Flygtransfer - Buss .",
        "displayNumber": ".",
        "num": ".",
        "line": ".",
        "lineId": "1277098400001",
        "catOut": "BAX",
        "catIn": "BAX",
        "catCode": "3",
        "cls": "8",
        "catOutS": "BAX",
        "catOutL": "Flygtransfer - Buss",
        "operatorCode": "277",
        "operator": "Flygbussarna",
        "admin": "277___",
        "matchId": "984;984;227771"
      },
      "Product": [
        {
          "icon": {
            "res": "prod_gen"
          },
          "name": "Flygtransfer - Buss .",
          "internalName": "Flygtransfer - Buss .",
          "displayNumber": ".",
          "num": ".",
          "line": ".",
          "lineId": "1277098400001",
          "catOut": "BAX",
          "catIn": "BAX",
          "catCode": "3",
          "cls": "8",
          "catOutS": "BAX",
          "catOutL": "Flygtransfer - Buss",
          "operatorCode": "277",
          "operator": "Flygbussarna",
          "admin": "277___",
          "routeIdxFrom": 4,
          "routeIdxTo": 11,
          "matchId": "984;984;227771"
        }
      ],
      "Notes": {
        "Note": [
          {
            "value": "WiFi",
            "key": "AW",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "WiFi"
          },
          {
            "value": "Lag 2015:953 tillämpas",
            "key": "EG",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "Lag 2015:953 tillämpas"
          }
        ]
      },
      "name": "Flygtransfer - Buss .",
      "type": "ST",
      "stop": "Torsplan (Stockholm kn)",
      "stopid": "A=1@O=Torsplan (Stockholm kn)@X=18032883@Y=59345400@U=1@L=740046074@",
      "stopExtId": "740046074",
      "time": "14:15:00",
      "date": "2024-03-05",
      "reachable": true,
      "direction": "Arlanda terminal 2-3 buss (Sigtuna kn)",
      "directionFlag": "2"
    },
    {
      "JourneyDetailRef": {
        "ref": "1|52090|21|1|5032024"
      },
      "JourneyStatus": "P",
      "ProductAtStop": {
        "icon": {
          "res": "prod_gen"
        },
        "name": "Flygtransfer - Buss .",
        "internalName": "Flygtransfer - Buss .",
        "displayNumber": ".",
        "num": ".",
        "line": ".",
        "lineId": "1277098400001",
        "catOut": "BAX",
        "catIn": "BAX",
        "catCode": "3",
        "cls": "8",
        "catOutS": "BAX",
        "catOutL": "Flygtransfer - Buss",
        "operatorCode": "277",
        "operator": "Flygbussarna",
        "admin": "277___",
        "matchId": "984;984;227798"
      },
      "Product": [
        {
          "icon": {
            "res": "prod_gen"
          },
          "name": "Flygtransfer - Buss .",
          "internalName": "Flygtransfer - Buss .",
          "displayNumber": ".",
          "num": ".",
          "line": ".",
          "lineId": "1277098400001",
          "catOut": "BAX",
          "catIn": "BAX",
          "catCode": "3",
          "cls": "8",
          "catOutS": "BAX",
          "catOutL": "Flygtransfer - Buss",
          "operatorCode": "277",
          "operator": "Flygbussarna",
          "admin": "277___",
          "routeIdxFrom": 4,
          "routeIdxTo": 11,
          "matchId": "984;984;227798"
        }
      ],
      "Notes": {
        "Note": [
          {
            "value": "WiFi",
            "key": "AW",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "WiFi"
          },
          {
            "value": "Lag 2015:953 tillämpas",
            "key": "EG",
            "type": "A",
            "routeIdxFrom": 4,
            "routeIdxTo": 11,
            "txtN": "Lag 2015:953 tillämpas"
          }
        ]
      },
      "name": "Flygtransfer - Buss .",
      "type": "ST",
      "stop": "Torsplan (Stockholm kn)",
      "stopid": "A=1@O=Torsplan (Stockholm kn)@X=18032883@Y=59345400@U=1@L=740046074@",
      "stopExtId": "740046074",
      "time": "14:45:00",
      "date": "2024-03-05",
      "reachable": true,
      "direction": "Arlanda terminal 2-3 buss (Sigtuna kn)",
      "directionFlag": "2"
    }
  ],
  "TechnicalMessages": {
    "TechnicalMessage": [
      {
        "value": "2024-03-05 11:10:33",
        "key": "requestTime"
      }
    ]
  },
  "serverVersion": "2.25.0",
  "dialectVersion": "2.25",
  "planRtTs": "1970-01-01T01:00:00.000+01:00",
  "requestId": "pqm6jjeqmici8ics"
};

let resrobotKey =  '8e4ebd51-b764-4f5f-8e48-12cdec7b2945'; // 25000 per month
let idTorsplan = '740046074';
let idNorraSt = '740046187';
let idOdenplan = '';
let idT4 = '';
let idArlanda = '';

getData(idTorsplan, "stop1");
getData(idNorraSt, "stop2");

// Get the timetables data from free API at trafiklab.se
function getData(id,divelement){
  let url = 'https://api.resrobot.se/v2.1/departureBoard?id='+id+'&format=json&accessId='+resrobotKey+'&operators=277&maxJourneys=10&duration=1000';
  console.log("Fetching data with URL: " + url);
  
  fetch(url).then(response => {
    return response.json();
  }).then(data => {

    console.log("fetched");
    addTimetable(data, divelement);
    
  }).catch(err => {
    // Do something for an error here
  });
}

//Formats string of date YYYY-MM-DD to MM/DD
function formatDate(inputDate) {
    let parts = inputDate.split("-");
    let formattedDate = parts[1] + "/" + parts[2];
    return formattedDate;
}

//Creates one new timetable box for a stop from the data
function addTimetable(stopData, divelement){
  console.log("Departures feteched: "+stopData.Departure.length);
  let html='';
  html += '<div class="namerow">'+stopData.Departure[0].stop.split(' ')[0]+'</div>';
  html += '<div class="tablerow defrow"><div>Time</div><div>Destination</div><div>Line</div></div>';
  
  for (let i = 0; i < 10; i++) {
    let d = stopData.Departure[i];
    if(i%2 === 0){
      html += '<div class="tablerow roweven"><div>'+d.time.substring(0,5)+'</div><div>'+stopData.Departure[i].direction.split(' ')[0]+'</div><div>'+d.time.substring(0,5)+'</div></div>';
    }else{
      html += '<div class="tablerow rowodd"><div>'+d.time.substring(0,5)+'</div><div>'+stopData.Departure[i].direction.split(' ')[0]+'</div><div>'+d.time.substring(0,5)+'</div></div>';
    }
    //console.log(departure);
  }
  document.getElementById(divelement).innerHTML = html;
}

//addTimetable(tempData, 'stop1');